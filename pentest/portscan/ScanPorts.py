#-------------------------------------------------------------
 # 
 #   .SYNOPSIS
 #   ScanPorts - a simple, Scapy-based port scanning tool
 #   
 #   .NOTES
 #   Author: Charles Christensen
 #   
#-------------------------------------------------------------

#==========================================
#  PARMETERS / VARIABLES
#==========================================

# Import libraries.
import scapy.all as scapy
from termcolor import colored
import magic
import sys
import os

# Define variables.
targets = []
ports = []
params = sys.argv.copy()
params[0] = ""

help_text = '''

SYNOPSIS
    ScanPorts - a simple, Scapy-based port scanning tool

OPTIONS
    -h, --help, -?, ?
        Display this help page
'''

#==========================================
#  FUNCTIONS
#==========================================

def printcolor(color, message, newline=TRUE):
    
    class colors:
        GREEN = '\033[92m'
        YELLOW = '\033[93m'
        RED = '\033[91m'
        ENDC = '\033[0m'
    
    if color == "GREEN":
        print(colors.GREEN, end='')
    if color == "YELLOW":
        print(colors.YELLOW, end='')
    if color == "RED":
        print(colors.RED, end='')
    if color == "WHITE":
        print(colors.ENDC, end='')
    
    print(message, end='')
    
    if newline:
        print(colors.ENDC)
    else:
        print(colors.ENDC, end='')



#==========================================
#  MAIN
#==========================================

# Parse CLI parameters.
index = 0
for param in params:
    param = param.lower()
    
    # Help flag.
    if param == "-h" or param == "-?" or param == "?" or param == "--help":
        print(help_text)
        sys.exit()
    
    # Target host flag.
    if param == "-t" or param == "--target":
        if os.path.isfile(params[index+1]):
            file_path = params[index+1]
            file_type = magic.Magic(mime=True)
            if file_type.from_file(file_path) != "text/plain":
                printcolor("RED", "ERROR! Invalid targets file specified. Must be multiline text file.")
    
    index++


    
print(str(params))